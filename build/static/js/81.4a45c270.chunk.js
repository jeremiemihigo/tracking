(self.webpackChunkfront=self.webpackChunkfront||[]).push([[81],{833269:(t,e,n)=>{"use strict";n.d(e,{A:()=>w});var r=n(409950),a=n(463464),i=n(428170),s=n(182053),o=n(198587),c=n(58168),u=n(672004),d=n(147896),l=n(559254),h=n(548283),f=n(110178),p=n(107594);function g(t){return(0,p.Ay)("MuiDialogActions",t)}(0,f.A)("MuiDialogActions",["root","spacing"]);var m=n(244414);const $=["className","disableSpacing"],y=(0,l.Ay)("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disableSpacing&&e.spacing]}})((t=>{let{ownerState:e}=t;return(0,c.A)({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})})),x=r.forwardRef((function(t,e){const n=(0,h.A)({props:t,name:"MuiDialogActions"}),{className:r,disableSpacing:a=!1}=n,i=(0,o.A)(n,$),s=(0,c.A)({},n,{disableSpacing:a}),l=(t=>{const{classes:e,disableSpacing:n}=t,r={root:["root",!n&&"spacing"]};return(0,d.A)(r,g,e)})(s);return(0,m.jsx)(y,(0,c.A)({className:(0,u.A)(l.root,r),ownerState:s,ref:e},i))})),v=x;var S=n(395876);function w(t){const{confirmDialog:e,setConfirmDialog:n}=t;return(0,m.jsxs)(a.A,{open:e.isOpen,sx:A.dialog,children:[(0,m.jsxs)(i.A,{sx:A.contentDialog,children:[(0,m.jsx)(s.A,{variant:"h6",children:e.title}),(0,m.jsx)(s.A,{variant:"subtitle2",children:e.subTitle})]}),(0,m.jsxs)(v,{sx:A.contentButton,children:[(0,m.jsx)(S.Ay,{type:"primary",onClick:e.onConfirm,children:"Yes"}),(0,m.jsx)(S.Ay,{type:"primary",danger:!0,onClick:()=>n({...e,isOpen:!1}),children:"No"})]})]})}const A={dialog:{padding:"5px",position:"absolute",top:"5px"},contentDialog:{textAlign:"center",width:"20rem"},contentButton:{justifyContent:"center"}}},702564:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});const r=n.p+"static/media/excelIcon.9e98a29762a5db040b12.jpg";var a=n(255271),i=n(244414);const s=function(t){let{data:e,fileName:n,sheetName:s}=t;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("img",{style:{cursor:"pointer"},src:r,alt:"excel",width:60,height:30,onClick:()=>(t=>{const e=a.Wp.json_to_sheet(t),r=a.Wp.book_new();a.Wp.book_append_sheet(r,e,s),a._h(r,"".concat(n,".xlsx"))})(e)})})}},698114:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});n(409950);const r=n.p+"static/media/loader.a8e321df755614ca01e3.gif";var a=n(244414);const i=function(t){let{width:e,height:n}=t;return(0,a.jsx)("div",{style:{display:"flex",alignContent:"center",justifyContent:"center",width:"100%",marginTop:"30px"},children:(0,a.jsx)("img",{width:e,height:n,src:r,alt:"Loading"})})}},767277:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>b});var r=n(902235),a=n(260899),i=n(314136),s=n(833269),o=n(702564),c=n(698114),u=n(150098),d=n(504159),l=n.n(d),h=n(409950),f=n(339579),p=n(315770),g=n(602174),m=n(182053),$=n(255271),y=n(477515),x=n(29246),v=n(689505),S=n(541233),w=n(244414);const A=function(){const[t,e]=h.useState(!1),[n,r]=h.useState(),[i,s]=S.Ay.useMessage(),o=(t,e)=>{i.open({type:e,content:""+t,duration:3})};return(0,w.jsxs)("div",{children:[s,(0,w.jsx)(g.A,{open:t}),(0,w.jsxs)(a.Ay,{container:!0,children:[(0,w.jsxs)(a.Ay,{item:!0,lg:8,sx:{paddingLeft:"10px"},children:[(0,w.jsx)(m.A,{component:"p",noWrap:!0,children:"File"}),(0,w.jsx)(y.A,{type:"file",name:"upload",id:"upload",onChange:t=>(t=>{t.preventDefault();try{if(t.target.files){e(!0);const n=new FileReader;n.onload=t=>{const n=t.target.result,a=$.LF(n,{type:"array"}),i=a.SheetNames[0],s=a.Sheets[i],o=$.Wp.sheet_to_json(s);r(o),e(!1)},n.readAsArrayBuffer(t.target.files[0])}}catch(n){o("Error "+n,"error")}})(t)})]}),(0,w.jsx)(a.Ay,{item:!0,lg:4,sx:{paddingLeft:"10px"},children:(0,w.jsx)(v.A,{color:"primary",variant:"contained",onClick:t=>(async t=>{t.preventDefault();try{if(n&&n.length>0){const t=await x.A.post(p.wp+"/datatotrack",{data:n},p.$W);413===t.status&&o("Le fichier ne doit pas depasser 50mb","error"),200===t.status&&(o(t.data,"success"),window.location.replace("/tracker/data_to_track")),201===t.status&&o(t.data,"error")}else o("Aucun Client trouv\xe9","error")}catch(e){o(""+e,"error")}})(t),children:"sendData"})})]})]})};const b=function(){const t=(0,f.d4)((t=>t.data_to_track)),[e,n]=h.useState(),d=(0,f.d4)((t=>{var e;return null===(e=t.user)||void 0===e?void 0:e.user})),g=t=>{return t.client.length>0&&t.client[0].result.length>0?(e=t.client[0].result[t.client[0].result.length-1]).delaiPrevu-(0,p.xE)(e.dateFin,e.dateDebut)>=0?"INSLA":"OUTSLA":"";var e},m=(t,e)=>{var n,r;return 0===t.client.length||0===(null===(n=t.client[0])||void 0===n?void 0:n.result.length)?"No result":(null===(r=t.client[0])||void 0===r?void 0:r.result.length)>0?t.client[0].result[t.client[0].result.length-1][""+e]:void 0},$=[{field:"unique_account_id",headerName:"code client",width:115,editable:!1},{field:"customer_name",headerName:"NOMS",width:100,editable:!1},{field:"statut",headerName:"statut",width:150,editable:!1},{field:"date",headerName:"Date",width:50,editable:!1,renderCell:t=>"No result"===t.row.date?"No result":l()(t.row.date).format("DD/MM")},{field:"nom",headerName:"Nom",width:80,editable:!1},{field:"feedbackSelect",headerName:"Action select",width:120,editable:!1},{field:"commentaire",headerName:"Commentaire",width:150,editable:!1},{field:"shop",headerName:"Shop",width:80,editable:!1},{field:"region",headerName:"Region",width:80,editable:!1},{field:"par",headerName:"PAR",width:80,editable:!1},{field:"sla",headerName:"SLA",width:70,editable:!1,renderCell:t=>"INSLA"===t.row.sla?(0,w.jsx)("p",{style:{background:"#619f62",color:"#fff",fontSize:"9px",padding:"2px",borderRadius:"5px"},children:"INSLA"}):(0,w.jsx)("p",{style:{background:"#971a0b",color:"#fff",fontSize:"10px",padding:"2px",borderRadius:"5px"},children:"OUTSLA"})}],[y,x]=h.useState({isOpen:!1,title:"",subTitle:""});return h.useEffect((()=>{(null===t||void 0===t?void 0:t.datatotrack.length)>0&&(()=>{let e=[];for(let n=0;n<t.datatotrack.length;n++)e.push({unique_account_id:t.datatotrack[n].unique_account_id,customer_name:t.datatotrack[n].customer_name,region:t.datatotrack[n].region,shop:t.datatotrack[n].shop,par:t.datatotrack[n].par,last_status:t.datatotrack[n].last_status,person_in_charge:t.datatotrack[n].person_in_charge,month:t.datatotrack[n].month,sla:g(t.datatotrack[n]),statut:m(t.datatotrack[n],"action"),date:m(t.datatotrack[n],"dateFin"),nom:m(t.datatotrack[n],"codeAgent"),feedbackSelect:m(t.datatotrack[n],"feedbackSelect"),commentaire:m(t.datatotrack[n],"commentaire"),id:t.datatotrack[n]._id});console.log(e),n(e)})()}),[t]),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(r.A,{sx:{padding:"5px",marginBottom:"10px"},children:e&&e.length>0?(0,w.jsx)(o.A,{data:e,title:"",fileName:"Data to track ".concat(e[0].month),sheetName:e[0].month}):(0,w.jsx)("p",{style:{padding:"0px",margin:"0px"},children:"Loading..."})}),(0,w.jsxs)(u.A,{children:[(0,w.jsxs)(a.Ay,{container:!0,children:[(0,w.jsxs)(a.Ay,{item:!0,lg:12,children:[!e&&(0,w.jsx)(c.A,{width:200,height:200}),"success"===t.readdatatotrack&&e&&e.length>0&&(0,w.jsx)("div",{style:{width:"100%"},children:(0,w.jsx)(i.zh,{rows:e,columns:$,initialState:{pagination:{paginationModel:{pageSize:20}}},pageSizeOptions:[20],disableRowSelectionOnClick:!0})})]}),(0,p.a0)(null===d||void 0===d?void 0:d.role)&&(0,w.jsx)(A,{})]}),(0,w.jsx)(s.A,{confirmDialog:y,setConfirmDialog:x})]})]})}},504159:function(t){t.exports=function(){"use strict";var t=1e3,e=6e4,n=36e5,r="millisecond",a="second",i="minute",s="hour",o="day",c="week",u="month",d="quarter",l="year",h="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],n=t%100;return"["+t+(e[(n-20)%10]||e[n]||e[0])+"]"}},$=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},y={s:$,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),a=n%60;return(e<=0?"+":"-")+$(r,2,"0")+":"+$(a,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),a=e.clone().add(r,u),i=n-a<0,s=e.clone().add(r+(i?-1:1),u);return+(-(r+(n-a)/(i?a-s:s-a))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:u,y:l,w:c,d:o,D:h,h:s,m:i,s:a,ms:r,Q:d}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},x="en",v={};v[x]=m;var S="$isDayjsObject",w=function(t){return t instanceof k||!(!t||!t[S])},A=function t(e,n,r){var a;if(!e)return x;if("string"==typeof e){var i=e.toLowerCase();v[i]&&(a=i),n&&(v[i]=n,a=i);var s=e.split("-");if(!a&&s.length>1)return t(s[0])}else{var o=e.name;v[o]=e,a=o}return!r&&a&&(x=a),a||!r&&x},b=function(t,e){if(w(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new k(n)},D=y;D.l=A,D.i=w,D.w=function(t,e){return b(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var k=function(){function m(t){this.$L=A(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[S]=!0}var $=m.prototype;return $.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(D.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(p);if(r){var a=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],a,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],a,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(e)}(t),this.init()},$.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},$.$utils=function(){return D},$.isValid=function(){return!(this.$d.toString()===f)},$.isSame=function(t,e){var n=b(t);return this.startOf(e)<=n&&n<=this.endOf(e)},$.isAfter=function(t,e){return b(t)<this.startOf(e)},$.isBefore=function(t,e){return this.endOf(e)<b(t)},$.$g=function(t,e,n){return D.u(t)?this[e]:this.set(n,t)},$.unix=function(){return Math.floor(this.valueOf()/1e3)},$.valueOf=function(){return this.$d.getTime()},$.startOf=function(t,e){var n=this,r=!!D.u(e)||e,d=D.p(t),f=function(t,e){var a=D.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?a:a.endOf(o)},p=function(t,e){return D.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},g=this.$W,m=this.$M,$=this.$D,y="set"+(this.$u?"UTC":"");switch(d){case l:return r?f(1,0):f(31,11);case u:return r?f(1,m):f(0,m+1);case c:var x=this.$locale().weekStart||0,v=(g<x?g+7:g)-x;return f(r?$-v:$+(6-v),m);case o:case h:return p(y+"Hours",0);case s:return p(y+"Minutes",1);case i:return p(y+"Seconds",2);case a:return p(y+"Milliseconds",3);default:return this.clone()}},$.endOf=function(t){return this.startOf(t,!1)},$.$set=function(t,e){var n,c=D.p(t),d="set"+(this.$u?"UTC":""),f=(n={},n[o]=d+"Date",n[h]=d+"Date",n[u]=d+"Month",n[l]=d+"FullYear",n[s]=d+"Hours",n[i]=d+"Minutes",n[a]=d+"Seconds",n[r]=d+"Milliseconds",n)[c],p=c===o?this.$D+(e-this.$W):e;if(c===u||c===l){var g=this.clone().set(h,1);g.$d[f](p),g.init(),this.$d=g.set(h,Math.min(this.$D,g.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},$.set=function(t,e){return this.clone().$set(t,e)},$.get=function(t){return this[D.p(t)]()},$.add=function(r,d){var h,f=this;r=Number(r);var p=D.p(d),g=function(t){var e=b(f);return D.w(e.date(e.date()+Math.round(t*r)),f)};if(p===u)return this.set(u,this.$M+r);if(p===l)return this.set(l,this.$y+r);if(p===o)return g(1);if(p===c)return g(7);var m=(h={},h[i]=e,h[s]=n,h[a]=t,h)[p]||1,$=this.$d.getTime()+r*m;return D.w($,this)},$.subtract=function(t,e){return this.add(-1*t,e)},$.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var r=t||"YYYY-MM-DDTHH:mm:ssZ",a=D.z(this),i=this.$H,s=this.$m,o=this.$M,c=n.weekdays,u=n.months,d=n.meridiem,l=function(t,n,a,i){return t&&(t[n]||t(e,r))||a[n].slice(0,i)},h=function(t){return D.s(i%12||12,t,"0")},p=d||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(g,(function(t,r){return r||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return D.s(e.$y,4,"0");case"M":return o+1;case"MM":return D.s(o+1,2,"0");case"MMM":return l(n.monthsShort,o,u,3);case"MMMM":return l(u,o);case"D":return e.$D;case"DD":return D.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return l(n.weekdaysMin,e.$W,c,2);case"ddd":return l(n.weekdaysShort,e.$W,c,3);case"dddd":return c[e.$W];case"H":return String(i);case"HH":return D.s(i,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return p(i,s,!0);case"A":return p(i,s,!1);case"m":return String(s);case"mm":return D.s(s,2,"0");case"s":return String(e.$s);case"ss":return D.s(e.$s,2,"0");case"SSS":return D.s(e.$ms,3,"0");case"Z":return a}return null}(t)||a.replace(":","")}))},$.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},$.diff=function(r,h,f){var p,g=this,m=D.p(h),$=b(r),y=($.utcOffset()-this.utcOffset())*e,x=this-$,v=function(){return D.m(g,$)};switch(m){case l:p=v()/12;break;case u:p=v();break;case d:p=v()/3;break;case c:p=(x-y)/6048e5;break;case o:p=(x-y)/864e5;break;case s:p=x/n;break;case i:p=x/e;break;case a:p=x/t;break;default:p=x}return f?p:D.a(p)},$.daysInMonth=function(){return this.endOf(u).$D},$.$locale=function(){return v[this.$L]},$.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=A(t,e,!0);return r&&(n.$L=r),n},$.clone=function(){return D.w(this.$d,this)},$.toDate=function(){return new Date(this.valueOf())},$.toJSON=function(){return this.isValid()?this.toISOString():null},$.toISOString=function(){return this.$d.toISOString()},$.toString=function(){return this.$d.toUTCString()},m}(),M=k.prototype;return b.prototype=M,[["$ms",r],["$s",a],["$m",i],["$H",s],["$W",o],["$M",u],["$y",l],["$D",h]].forEach((function(t){M[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),b.extend=function(t,e){return t.$i||(t(e,k,b),t.$i=!0),b},b.locale=A,b.isDayjs=w,b.unix=function(t){return b(1e3*t)},b.en=v[x],b.Ls=v,b.p={},b}()}}]);