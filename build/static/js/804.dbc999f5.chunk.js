"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[804],{963643:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(902235),s=n(260899),l=n(182053),r=n(244414);const o=e=>{let{title:t,count:n,bg:o}=e;return(0,r.jsx)(i.A,{sx:{padding:"4px"},children:(0,r.jsxs)("div",{style:{minWidth:"5rem"},children:[(0,r.jsxs)(s.Ay,{container:!0,children:[(0,r.jsx)(s.Ay,{item:!0,lg:10,xs:10,sm:10,md:10,children:(0,r.jsx)(l.A,{component:"p",sx:{fontSize:"12px",fontWeight:"bolder"},noWrap:!0,children:t})}),(0,r.jsx)(s.Ay,{item:!0,lg:2,xs:2,sm:2,md:2,sx:{background:"#002d72",borderRadius:"20px",textAlign:"center",color:"white"},children:(0,r.jsx)(l.A,{component:"p",children:n})})]}),(0,r.jsxs)(s.Ay,{container:!0,alignItems:"center",children:[(0,r.jsx)(s.Ay,{item:!0,lg:4,xs:4,sx:{padding:"4px"},children:(0,r.jsxs)("div",{style:{background:"#068E14",color:"#fff",padding:"5px",borderRadius:"10px"},children:[(0,r.jsx)(l.A,{variant:"h6",sx:{textAlign:"center",fontSize:"6px",margin:"0px",padding:"0px"},color:"inherit",children:"IN SLA"}),(0,r.jsx)(l.A,{variant:"h6",sx:{textAlign:"center",fontWeight:"bolder"},color:"inherit",children:o.nombreIn})]})}),(0,r.jsx)(s.Ay,{item:!0,lg:4,xs:4,sx:{padding:"4px"},children:(0,r.jsxs)("div",{style:{background:"#EE1912",color:"#fff",padding:"5px",borderRadius:"10px"},children:[(0,r.jsx)(l.A,{variant:"h6",sx:{textAlign:"center",fontSize:"6px"},color:"inherit",children:"OUT SLA"}),(0,r.jsx)(l.A,{variant:"h6",sx:{textAlign:"center",fontWeight:"bolder"},color:"inherit",children:o.nombreOut})]})}),(0,r.jsx)(s.Ay,{item:!0,lg:4,xs:4,sx:{padding:"5px"},children:(0,r.jsxs)("div",{style:{background:"#FEF6AA",padding:"5px",borderRadius:"10px"},children:[(0,r.jsx)(l.A,{variant:"h6",sx:{textAlign:"center",fontSize:"6px"},color:"inherit",children:"Today"}),(0,r.jsx)(l.A,{variant:"h6",sx:{textAlign:"center",fontWeight:"bolder"},color:"inherit",children:o.today})]})})]})]})})}},386292:(e,t,n)=>{n.d(t,{A:()=>x});var i=n(8145),s=n(718346),l=n(345735),r=n(811942),o=n.n(r),a=n(244414);const d=(0,s.Z)();function c(e){let{value:t,setValue:n,options:s,title:r,propr:o}=e;return(0,a.jsx)(l.A,{value:t,onChange:(e,t)=>{"string"===typeof t?n({title:t}):t&&t.inputValue?n({title:t.inputValue}):n(t)},filterOptions:(e,t)=>d(e,t),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with-text-demo",options:s,getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e[""+o],renderOption:(e,t)=>(0,a.jsx)("li",{...e,children:t[""+o]}),sx:{width:"100%"},freeSolo:!0,renderInput:e=>(0,a.jsx)(i.A,{...e,label:r||"Titre"})})}c.propType={value:o().string,setValue:o().func,options:o().array,title:o().string,propr:o().string};const x=c},698114:(e,t,n)=>{n.d(t,{A:()=>l});n(409950);const i=n.p+"static/media/loader.a8e321df755614ca01e3.gif";var s=n(244414);const l=function(e){let{width:t,height:n}=e;return(0,s.jsx)("div",{style:{display:"flex",alignContent:"center",justifyContent:"center",width:"100%",marginTop:"30px"},children:(0,s.jsx)("img",{width:t,height:n,src:i,alt:"Loading"})})}},591927:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(409950),s=n(19647),l=n(23266),r=n(625979),o=n(770006),a=n(244414);const d=function(e){const{label:t,data:n,value:d,setValue:c}=e,[x,p]=i.useState(!1);return(0,a.jsxs)(r.A,{sx:{width:"100%"},children:[(0,a.jsx)(s.A,{id:"demo-controlled-open-select-label",children:t}),(0,a.jsx)(o.A,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:x,onClose:()=>{p(!1)},onOpen:()=>{p(!0)},value:d,label:t,onChange:e=>{c(e.target.value)},children:function(e){return e.map(((e,t)=>(0,a.jsx)(l.A,{value:e.value||e.id,children:e.title},t)))}(n)})]})}},315069:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_e});var i=n(902235),s=n(182053),l=n(663825),r=n(409950),o=n(339579),a=n(150098),d=n(244414);const c=(0,r.createContext)(),x=e=>{const[t,n]=r.useState({id:24,title:"All customer"});return(0,d.jsx)(c.Provider,{value:{handleSelect:e=>{n(e)},optionSelect:t},children:e.children})},p=r.memo(x);var u=n(591927),h=n(315770),g=n(29246),j=n(260899),m=n(10302),f=n(220760),v=n(504159),A=n.n(v);const y=function(e){let{data:t}=e;const[n,s]=r.useState("");return(0,d.jsx)("div",{children:(0,d.jsx)(j.Ay,{sx:{marginTop:"10px"},children:t&&t.map((e=>(0,d.jsxs)(i.A,{sx:{cursor:"pointer",marginBottom:"10px",padding:"10px"},onClick:()=>s(e._id),children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("p",{children:[e.unique_account_id,"; ",e.customer_name]}),(0,d.jsxs)("p",{style:{display:"flex"},children:["Statut : ",(0,d.jsxs)("p",{children:[" ","  "+e.action.title]})," ",(0,d.jsxs)("p",{style:{marginLeft:"10px",background:"".concat((0,h.xE)(new Date,e.updatedAt)-e.action.delai>=0?"#dedede":"#7B3030"),color:"".concat((0,h.xE)(new Date,e.updatedAt)-e.action.delai>=0?"#000":"#fff"),borderRadius:"10px",fontSize:"10px",fontWeight:"bolder",padding:"1px 10px"},children:[(0,h.xE)(new Date,e.updatedAt)-e.action.delai," jour(s)"]})]})]}),n===e._id&&(0,d.jsxs)(j.Ay,{container:!0,children:[(0,d.jsxs)(j.Ay,{item:!0,lg:4,children:[(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"customer_status :"})," ",e.customer_status]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"enable_status :"})," ",e.enable_status]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"date_timestamp :"})," ",A()(e.date_timestamp).format("DD/MM/YYYY")]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"expiry_timestamp :"})," ",A()(e.default_timestamp).format("DD/MM/YYYY")," \xe0"," ","".concat(new Date(e.default_timestamp).getHours(),":").concat(new Date(e.default_timestamp).getMinutes())]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"par_to_date :"})," ",e.par_to_date]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"payment_status :"})," ",e.payment_status]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"shop_region :"})," ",e.shop_region,"/",e.shop_name]})]}),e.result.length>0&&(0,d.jsxs)(j.Ay,{item:!0,lg:8,children:[e.result.map(((t,n)=>(0,d.jsxs)(j.Ay,{className:"actionsChild",children:[(0,d.jsx)("div",{className:"result",children:(0,d.jsx)(m.A,{index:t})}),(0,d.jsx)("div",{className:"icon",children:e.result.length-1===n&&(0,d.jsx)(f.A,{fontSize:"small"})})]},t._id))),(0,d.jsx)("p",{})]})]})]},e._id)))})})};var b=n(716491),S=n(625979),w=n(616497),C=n(93038),_=n(139452);const k=function(e){let{data:t}=e;const n={options:{},series:t.series,labels:t.labels};return(0,d.jsx)("div",{className:"donut",children:(0,d.jsx)(_.A,{options:n.options,series:n.series,type:"donut",width:"380"})})};var E=n(963643),z=n(541397),O=n.n(z),W=n(8145),D=n(718346),I=n(345735);const R=(0,D.Z)();const M=function(e){let{value:t,setValue:n,options:i,title:s}=e;return(0,d.jsx)(I.A,{value:t,onChange:(e,t)=>{"string"===typeof t?n(t):t&&t.inputValue?n(t.inputValue):n(t)},filterOptions:(e,t)=>R(e,t),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with-text-demo",options:i,getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e,renderOption:(e,t)=>(0,d.jsx)("li",{...e,children:t}),sx:{width:"100%"},freeSolo:!0,renderInput:e=>(0,d.jsx)(W.A,{...e,label:s||"Titre"})})};var N=n(602174),L=n(541233);const T=function(){const{optionSelect:e}=r.useContext(c),[t,n]=r.useState(""),[i,s]=r.useState(""),l=(0,o.d4)((e=>{var t;return null===(t=e.role)||void 0===t?void 0:t.role})),[x,p]=r.useState(),[m,f]=r.useState(!1),[v,A]=L.Ay.useMessage(),_=async()=>{if(""!==i){f(!0),n("");const t=await g.A.get("".concat(h.EU,"/analyseRole/").concat(i),h.$W);f(!1),200===t.status&&p(t.data),201===t.status&&(e=t.data,v.open({type:"error",content:""+e,duration:3}),p())}var e};r.useEffect((()=>{_()}),[i]);const[z,W]=r.useState("client"),D=e=>{W(e.target.name)},[I,R]=r.useState(),[T,B]=r.useState(),[F,V]=r.useState();r.useEffect((()=>{(()=>{if(x&&x.length>0){let e=0,t=0;for(let l=0;l<x.length;l++)(0,h.xE)(x[l].updatedAt,new Date)>x[l].action.delai?t+=1:e+=1;R({series:[e,t],labels:["insla","outsla"]});let n=O().groupBy(x,"action.title"),i=Object.keys(n);V(i);let s=[];for(let l=0;l<i.length;l++)s.push({action:i[l],visites:n[""+i[l]]});B(s)}})()}),[x]);const[Y,P]=r.useState();return r.useEffect((()=>{if(x&&t){let e=x.filter((e=>e.action.title===t));P(e)}else P(x)}),[t,x]),(0,d.jsxs)("div",{children:[(0,d.jsx)(d.Fragment,{children:A}),(0,d.jsx)(a.A,{title:"",children:(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,d.jsx)("p",{style:{fontSize:"15px",fontWeight:"bolder",textTransform:"uppercase",marginRight:"10px"},children:e.title}),(0,d.jsx)("div",{style:{width:"20%"},children:l&&l.length>0?(0,d.jsx)(u.A,{label:"Selectionnez le role",data:l,value:i,setValue:s}):(0,d.jsx)("p",{children:"Loading..."})}),F&&(0,d.jsx)("div",{style:{width:"30%",padding:"0px 5px"},children:(0,d.jsx)(M,{value:t,setValue:n,options:F,title:"Action",propr:""})}),Y&&Y.length>1&&(0,d.jsx)("div",{style:{width:"20%"},children:(0,d.jsxs)("p",{children:[Y.length," customers are waiting "]})}),(0,d.jsx)("div",{style:{width:"30%",margin:"0px 20px"},children:(0,d.jsxs)(b.A,{sx:{display:"flex"},children:[(0,d.jsx)(S.A,{component:"fieldset",variant:"standard",children:(0,d.jsx)(w.A,{control:(0,d.jsx)(C.A,{checked:"client"===z,onChange:D,name:"client"}),label:"Clients"})}),(0,d.jsx)(S.A,{required:!0,component:"fieldset",variant:"standard",children:(0,d.jsx)(w.A,{control:(0,d.jsx)(C.A,{checked:"analyse"===z,onChange:D,name:"analyse"}),label:"Analysis"})})]})})]})}),(0,d.jsx)(j.Ay,{container:!0,children:(0,d.jsxs)(j.Ay,{item:!0,lg:12,children:[Y&&"client"===z&&(0,d.jsx)(y,{data:Y}),x&&"analyse"===z&&(0,d.jsxs)(j.Ay,{container:!0,children:[(0,d.jsx)(j.Ay,{item:!0,lg:4,children:(0,d.jsx)(a.A,{title:"Deedline",children:x&&"analyse"===z&&(0,d.jsx)(k,{data:I})})}),(0,d.jsx)(j.Ay,{item:!0,lg:8,children:(0,d.jsx)(a.A,{title:"Analysis",children:(0,d.jsx)(j.Ay,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:T&&T.map((e=>(0,d.jsx)(j.Ay,{sx:{cursor:"pointer"},item:!0,xs:12,sm:6,md:4,lg:4,children:(0,d.jsx)(E.A,{title:e.action,count:e.visites.length})},e.action)))})})})]})]})}),(0,d.jsx)(N.A,{open:m})]})};var B=n(689505);const F=function(){const{optionSelect:e}=r.useContext(c),[t,n]=r.useState({debut:"",fin:""}),{debut:i,fin:s}=t,[l,o]=r.useState();return(0,d.jsxs)("div",{children:[(0,d.jsx)(a.A,{title:"",children:(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,d.jsx)("p",{style:{fontSize:"15px",fontWeight:"bolder",textTransform:"uppercase",marginRight:"10px"},children:e.title}),(0,d.jsx)(W.A,{type:"date",width:"20%",onChange:e=>n({...t,debut:e.target.value})}),(0,d.jsx)(W.A,{type:"date",width:"20%",onChange:e=>n({...t,fin:e.target.value})}),(0,d.jsx)(B.A,{onClick:()=>(async()=>{try{const e=await g.A.post(h.wp+"/deedline",{debut:i,fin:s},h.$W);o(e.data)}catch(e){console.log(e)}})(),children:"Valider"})]})}),(0,d.jsx)(j.Ay,{container:!0,sx:{marginTop:"10px"},children:l&&l.length>0&&l.map(((e,t)=>(0,d.jsx)(j.Ay,{item:!0,lg:6,sx:{padding:"5px"},children:(0,d.jsx)(a.A,{title:e.role,children:(0,d.jsxs)(j.Ay,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,d.jsx)(j.Ay,{sx:{background:"blue",width:"20%",fontSize:"20px",borderRadius:"20px",padding:"20px",marginRight:"10px",textAlign:"center"},children:e.result.insla}),(0,d.jsx)(j.Ay,{sx:{background:"red",width:"20%",fontSize:"20px",borderRadius:"20px",padding:"20px",textAlign:"center"},children:e.result.outsla})]})},t)},t)))})]})};var V=n(386292),Y=n(749715);const P=function(e){let{data:t}=e;const[n,s]=r.useState("");return(0,d.jsx)("div",{children:(0,d.jsx)(j.Ay,{sx:{marginTop:"10px"},children:t&&t.map((e=>(0,d.jsxs)(i.A,{sx:{cursor:"pointer",marginBottom:"10px",padding:"10px"},onClick:()=>s(e._id),children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("p",{children:[e.unique_account_id,"; ",e.customer_name]}),(0,d.jsxs)("p",{style:{display:"flex"},children:["Statut : ",(0,d.jsxs)("p",{children:[" ","  "+e.result.action]})," ",(0,d.jsxs)("p",{style:{marginLeft:"10px",background:"".concat((0,h.xE)(e.result.dateFin,e.result.dateDebut)-e.result.delaiPrevu>=0?"#dedede":"#7B3030"),color:"".concat((0,h.xE)(e.result.dateFin,e.result.dateDebut)-e.result.delaiPrevu>=0?"#000":"#fff"),borderRadius:"10px",fontSize:"10px",fontWeight:"bolder",padding:"1px 10px"},children:[(0,h.xE)(e.result.dateFin,e.result.dateDebut)-e.result.delaiPrevu," jour(s)"]})]})]}),n===e._id&&(0,d.jsxs)(j.Ay,{container:!0,children:[(0,d.jsxs)(j.Ay,{item:!0,lg:4,children:[(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"customer_status :"})," ",e.customer_status]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"enable_status :"})," ",e.enable_status]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"date_timestamp :"})," ",A()(e.date_timestamp).format("DD/MM/YYYY")]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"expiry_timestamp :"})," ",A()(e.default_timestamp).format("DD/MM/YYYY")," \xe0"," ","".concat(new Date(e.default_timestamp).getHours(),":").concat(new Date(e.default_timestamp).getMinutes())]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"par_to_date :"})," ",e.par_to_date]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"payment_status :"})," ",e.payment_status]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{children:"shop_region :"})," ",e.shop_region,"/",e.shop_name]})]}),(0,d.jsx)(j.Ay,{item:!0,lg:8,children:(0,d.jsx)(j.Ay,{className:"actionsChild",children:(0,d.jsx)("div",{className:"result",children:(0,d.jsx)(m.A,{index:e.result})})})})]})]},e._id)))})})};const U=function(){const{optionSelect:e}=r.useContext(c),t=(0,o.d4)((e=>{var t;return null===(t=e.agent)||void 0===t?void 0:t.agent})),[n,i]=r.useState(""),[s,l]=r.useState(),[x,p]=L.Ay.useMessage(),[u,j]=r.useState(),[m,f]=r.useState(!1),v=(e,t)=>{x.open({type:t,content:""+e,duration:3})};return(0,d.jsxs)("div",{children:[m&&(0,d.jsx)(N.A,{open:m}),p,(0,d.jsx)(a.A,{title:"",children:(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,d.jsx)("p",{style:{fontSize:"15px",fontWeight:"bolder",textTransform:"uppercase",marginRight:"10px"},children:e.title}),t&&t.length>0&&(0,d.jsx)("div",{style:{width:"30%",marginRight:"10px"},children:(0,d.jsx)(V.A,{value:n,setValue:i,options:t,title:"Agent",propr:"nom"})}),n&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(W.A,{type:"date",onChange:e=>l({...s,debut:e.target.value})}),(0,d.jsx)(W.A,{type:"date",onChange:e=>l({...s,fin:e.target.value}),sx:{padding:"0px 5px"}})]}),n&&(0,d.jsxs)(B.A,{variant:"contained",disabled:m,color:"primary",onClick:e=>(async e=>{e.preventDefault(),f(!0);const t=await g.A.post(h.wp+"/remotedBy",{codeAgent:n.codeAgent,debut:null===s||void 0===s?void 0:s.debut,fin:null===s||void 0===s?void 0:s.fin});f(!1),201===t.status&&(v(t.data,"error"),j()),200===t.status&&(j(t.data),v(t.data.length+" action(s) r\xe9alis\xe9e(s)","success"))})(e),children:[(0,d.jsx)(Y.A,{fontSize:"small"})," Chercher"]})]})}),u&&(0,d.jsx)(P,{data:u})]})};var H=n(176231);const Z=function(){const{optionSelect:e}=r.useContext(c),[t,n]=r.useState(""),[i,s]=r.useState(),[l,o]=L.Ay.useMessage(),x=async e=>{e.preventDefault();try{const e=await g.A.post(h.wp+"/analyseClient",{codeclient:t});200===e.status&&s(e.data),201===e.status&&(n=e.data,i="error",l.open({type:i,content:""+n,duration:3}))}catch(r){console.log(r)}var n,i};return(0,d.jsxs)("div",{children:[o,(0,d.jsx)(a.A,{title:"",children:(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,d.jsx)("p",{style:{fontSize:"15px",fontWeight:"bolder",textTransform:"uppercase",marginRight:"10px"},children:e.title}),(0,d.jsx)("div",{style:{width:"30%"},children:(0,d.jsx)(W.A,{onChange:e=>n(e.target.value),placeholder:"Code client",fullWidth:!0})}),(0,d.jsx)("div",{style:{width:"30%",marginLeft:"10px"},children:(0,d.jsxs)(B.A,{variant:"contained",color:"primary",onClick:e=>x(e),children:[(0,d.jsx)(H.vji,{fontSize:"small"})," recherche"]})})]})}),i&&(0,d.jsx)(y,{data:i})]})};const $=function(){const{optionSelect:e}=r.useContext(c),t=(0,o.d4)((e=>{var t;return null===(t=e.action)||void 0===t?void 0:t.action})),[n,i]=r.useState(""),[s,l]=r.useState(),[x,p]=L.Ay.useMessage(),[u,j]=r.useState(!1),m=async e=>{e.preventDefault(),j(!0);try{const e=await g.A.post(h.wp+"/attenteStatut",{idAction:null===n||void 0===n?void 0:n.idAction});j(!1),200===e.status&&l(e.data),201===e.status&&(t=e.data,i="error",x.open({type:i,content:""+t,duration:3}),l())}catch(s){console.log(s)}var t,i};return(0,d.jsxs)("div",{children:[p,(0,d.jsx)(N.A,{open:u}),(0,d.jsx)(a.A,{title:"",children:(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,d.jsx)("p",{style:{fontSize:"15px",fontWeight:"bolder",textTransform:"uppercase",marginRight:"10px"},children:e.title}),t&&(0,d.jsx)("div",{style:{width:"30%"},children:(0,d.jsx)(V.A,{value:n,options:t,setValue:i,title:"Selectionnez un statut",propr:"title"})}),(0,d.jsx)("div",{style:{width:"30%",marginLeft:"10px"},children:(0,d.jsxs)(B.A,{variant:"contained",color:"primary",onClick:e=>m(e),children:[(0,d.jsx)(H.vji,{fontSize:"small"})," recherche"]})})]})}),s&&(0,d.jsx)(y,{data:s})]})};var q=n(752472),K=n(314136),G=n(698114),J=n(783274),Q=n(302459),X=n(811942),ee=n.n(X);function te(e){let{action:t,role:n,nombre:l,outsla:r,insla:o,lastupdate:a,bg:c}=e;return(0,d.jsx)("div",{children:(0,d.jsx)(J.A,{title:t,children:(0,d.jsxs)(i.A,{elevation:2,sx:{padding:"5px",backgroundColor:c},children:[(0,d.jsx)(s.A,{noWrap:!0,style:{fontSize:"11px",textAlign:"center",fontWeight:700},children:t}),(0,d.jsx)(s.A,{component:"p",sx:{fontSize:"9px",textAlign:"center",padding:"0px",margin:"0px"},children:n}),(0,d.jsx)("p",{style:{fontSize:"25px",textAlign:"center",fontWeight:"bolder"},children:l}),(0,d.jsxs)(j.Ay,{sx:{display:"flex",justifyContent:"space-between",width:"100%"},children:[(0,d.jsxs)(j.Ay,{sx:ne.flex,children:[(0,d.jsxs)(j.Ay,{sx:ne.flexOutsla,children:[(0,d.jsx)(Q.A,{size:5,color:"error"}),(0,d.jsx)(s.A,{sx:{fontSize:"9px",marginLeft:"3px",fontWeight:"bolder",textAlign:"right"},component:"p",children:r})]}),(0,d.jsxs)(j.Ay,{sx:ne.flexInsla,children:[(0,d.jsx)(Q.A,{size:5,color:"success"}),(0,d.jsx)(s.A,{sx:{fontSize:"9px",marginLeft:"3px",fontWeight:"bolder",textAlign:"right"},component:"p",children:o})]})]}),(0,d.jsx)(s.A,{sx:{fontSize:"9px",textAlign:"right"},component:"p",children:a})]})]})})})}const ne={flex:{display:"flex",alignItems:"center",justifyContent:"center"},flexOutsla:{display:"flex",alignItems:"center",justifyContent:"center",marginRight:"10px"},flexInsla:{display:"flex",alignItems:"center",justifyContent:"center"}};te.prototype={action:ee().string,role:ee().string,nombre:ee().number,outsla:ee().number,insla:ee().number,lastupdate:ee().string,bg:ee().string};const ie=te;var se=n(686817);function le(e){let{data:t}=e;const[n,i]=r.useState(null),s=Boolean(n);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(H._Au,{onMouseEnter:e=>{i(e.currentTarget)},id:"demo-positioned-button","aria-controls":s?"demo-positioned-menu":void 0,"aria-haspopup":"true","aria-expanded":s?"true":void 0}),(0,d.jsx)(se.A,{id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:n,open:s,onClose:e=>{i(null)},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:t.map(((e,t)=>(0,d.jsxs)("p",{style:re.p,children:[t+1,". ",null===e||void 0===e?void 0:e.nom]},e._id)))})]})}const re={p:{fontSize:"12px",padding:"3px 30px",margin:"0px"}};le.prototype={data:ee().array};const oe=le;var ae=n(228429),de=n(482130),ce=n(259051),xe=n.n(ce);const pe=function(e){let{data:t}=e;return(0,d.jsx)("div",{style:{minWidth:"35rem"},children:t.map(((e,t)=>(0,d.jsx)(r.Fragment,{children:(0,d.jsx)(m.A,{index:e})},t)))})};const ue=function(){const[e,t]=r.useState(!1),[n,i]=r.useState(),c=(0,o.d4)((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.user})),[x,p]=r.useState(),[u,m]=r.useState(!0),[f,v]=r.useState(),[A,y]=r.useState(),[b,S]=r.useState();r.useEffect((()=>{n&&(()=>{if("field"===(0,h.sE)(null===c||void 0===c?void 0:c.role)||(0,h.a0)(null===c||void 0===c?void 0:c.role)){const e=Object.keys(O().groupBy(n,"action.idAction")),t=Object.keys(O().groupBy(n,"shop_region"));y({action:e,region:t})}if("ZBM"===(null===c||void 0===c?void 0:c.role)){const e=Object.keys(O().groupBy(n,"shop_name")),t=Object.keys(O().groupBy(n,"action.idAction"));S({action:t,shop:e})}})()}),[n,c]),r.useEffect((()=>{c&&(async()=>{try{if("managment"===(0,h.sE)(null===c||void 0===c?void 0:c.role)){m(!0);const e=await g.A.get(h.EU+"/readManagment",h.$W),t=await g.A.get("".concat(h.EU,"/teamrole/").concat(null===c||void 0===c?void 0:c.role),h.$W);m(!1),document.getElementById("leftContent").textContent="".concat(e.data.length," customers are waiting"),i(e.data),v(t.data)}if("managment"!==(0,h.sE)(null===c||void 0===c?void 0:c.role)||(0,h.a0)(null===c||void 0===c?void 0:c.role)){m(!0);const e=await g.A.get(h.EU+"/clientField",h.$W);m(!1),i(e.data),document.getElementById("leftContent").textContent="".concat(e.data.length," customers are waiting")}}catch(e){m(!1),console.log(e)}})()}),[c]);const w=[{field:"unique_account_id",headerName:"code client",width:120,editable:!1},{field:"customer_name",headerName:"NOMS",width:150,editable:!1},{field:"shop_name",headerName:"Shop",width:100,editable:!1},{field:"shop_region",headerName:"Region",width:100,editable:!1},{field:"payment_status",headerName:"Payment status",width:80,editable:!1},{field:"par_to_date",headerName:"PAR",width:80,editable:!1},{field:"actionTitle",headerName:"Action",width:180,editable:!1},{field:"In",headerName:"In charge",width:130,editable:!1,renderCell:e=>{var t;return e.row.client.length>0?null===(t=e.row.client[0])||void 0===t?void 0:t.person_in_charge:(0,d.jsx)("p",{style:{color:"red"},children:"does not exist in data to track"})}},{field:"a",headerName:"",width:30,editable:!1,renderCell:e=>(0,d.jsx)(q.A,{size:"small",color:"primary",onClick:()=>{return n=e.row.result,p(n),void t(!0);var n},children:e.row.result.length})}],C=(e,t,i)=>"shop"===i?n.filter((n=>n.actionEnCours===t&&n.shop_name===e)):"region"===i?n.filter((n=>n.actionEnCours===t&&n.shop_region===e)):void 0,_=e=>n.filter((t=>t.shop_region===e)),k=(0,ae.Zp)(),E=(e,t,n)=>{let i=C(e,t,n);k("/liste",{state:{visites:i,action:t}})},z=(0,o.d4)((e=>{var t;return null===(t=e.action)||void 0===t?void 0:t.action})),W=e=>n.filter((t=>t.actionEnCours===e)),D=e=>{var t;if(z&&z.length>0)return null===(t=O().filter(z,{idAction:e})[0])||void 0===t?void 0:t.title},[I,R]=L.Ay.useMessage(),M=e=>{const t={actions:D(e),clients:O().filter(n,{actionEnCours:e})};var i,s;t.clients.length>0?k("/liste",{state:{visites:t.clients,action:t.actions}}):(i="no customers for this status",s="error",I.open({type:s,content:""+i,duration:3}))},N=e=>{if(z){var t;var n;return(null===(t=z.filter((t=>t.idAction===e))[0])||void 0===t?void 0:t.roles).length>0?null===(n=z.filter((t=>t.idAction===e))[0])||void 0===n?void 0:n.roles[0].title:"maybe a household visit"}return"maybe a household visit"},[T,B]=r.useState({content:null,error:""}),{content:F}=T,{socket:V}=r.useContext(l.m);r.useEffect((()=>{V.on("renseigne",(e=>{"success"===e.error&&B({content:e.content[0]})}))}),[V]),r.useEffect((()=>{function e(){if(O().filter(n,{_id:F._id}).length>0){let e=n.map((e=>e._id===F._id?F:e));i(e)}else i({...n,content:F})}F&&n&&("ZBM"===(null===c||void 0===c?void 0:c.role)&&F.shop_region===(null===c||void 0===c?void 0:c.region)&&e(),("FIELD"===(null===c||void 0===c?void 0:c.role)||(0,h.OD)(null===c||void 0===c?void 0:c.role))&&e(),"RS"===(null===c||void 0===c?void 0:c.role)&&F.shop_name===(null===c||void 0===c?void 0:c.shop)&&e())}),[F]);const Y=(e,t)=>{if(n&&n.length>0){let i=O().orderBy(O().filter(n,{actionEnCours:e,shop_region:t}),"updatedAt","asc");return i.length>0?i[i.length-1].updatedAt:""}return""},P=(0,o.d4)((e=>{var t;return null===(t=e.today)||void 0===t?void 0:t.today})),U=(e,t)=>{let n=0;for(let i=0;i<e.length;i++)(0,h.Hl)({delaiPrevu:e[i].action.delai,dateFin:(null===P||void 0===P?void 0:P.unixtime)||(new Date).getTime(),dateDebut:e[i].updatedAt})===t&&(n+=1);return n},H=e=>{if(z&&z.length>0){let t=O().filter(z,{idAction:e})[0];return t.color?t.color:"#fff"}};return(0,d.jsxs)("div",{children:[R,(0,d.jsxs)(a.A,{title:"",children:[u&&!n&&(0,d.jsx)(G.A,{width:150,height:150}),(0,d.jsx)(j.Ay,{container:!0,children:A&&("field"===(0,h.sE)(null===c||void 0===c?void 0:c.role)||(0,h.a0)(null===c||void 0===c?void 0:c.role))&&(null===A||void 0===A?void 0:A.region.map(((e,t)=>(0,d.jsxs)(j.Ay,{item:!0,lg:2,xs:12,sm:12,md:6,children:[(0,d.jsxs)(j.Ay,{onClick:()=>{return t=_(e),void k("/region_monitoring",{state:{data:t,region:e}});var t},sx:{padding:"5px",cursor:"pointer",display:"flex",justifyContent:"space-between",backgroundColor:"#002d72",color:"#fff",margin:"3px"},children:[(0,d.jsx)("p",{children:e}),(0,d.jsx)("p",{children:_(e).length})]}),(0,d.jsx)(j.Ay,{container:!0,children:A.action.map((t=>C(e,t,"region").length>0&&(0,d.jsx)(j.Ay,{item:!0,lg:12,md:6,xs:6,sm:4,sx:{padding:"2px",cursor:"pointer"},onClick:()=>E(e,t,"region"),children:(0,d.jsx)(ie,{action:D(t),role:N(t),nombre:C(e,t,"region").length,outsla:U(C(e,t,"region"),"OUTSLA"),insla:U(C(e,t,"region"),"INSLA"),lastupdate:""!==Y(t,e)&&xe()(Y(t,e)).fromNow(),bg:H(t)})},t)))})]},t))))}),(0,d.jsx)(j.Ay,{container:!0,children:b&&"ZBM"===(null===c||void 0===c?void 0:c.role)&&b.shop.map(((e,t)=>(0,d.jsxs)(j.Ay,{item:!0,lg:3,xs:12,sm:6,md:6,sx:{paddingLeft:"1px"},children:[(0,d.jsx)(j.Ay,{sx:{backgroundColor:"#002d72",borderRadius:"2px",textAlign:"center",color:"#fff"},children:(0,d.jsx)(s.A,{component:"p",noWrap:!0,children:e})}),(0,d.jsx)(j.Ay,{container:!0,children:b.action.map((t=>C(e,t,"shop").length>0&&(0,d.jsx)(j.Ay,{item:!0,lg:12,md:6,xs:6,sm:12,sx:{padding:"2px",cursor:"pointer"},onClick:()=>E(e,t,"shop"),children:(0,d.jsx)(ie,{action:D(t),role:N(t),nombre:C(e,t,"shop").length,outsla:U(C(e,t,"shop"),"OUTSLA"),insla:U(C(e,t,"shop"),"INSLA"),lastupdate:""!==Y(t)&&xe()(Y(t)).fromNow(),bg:H(t)})},t)))})]},t)))}),n&&n.length>0&&"team"===(0,h.sE)(null===c||void 0===c?void 0:c.role)&&(0,d.jsx)(K.zh,{rows:n,columns:w,initialState:{pagination:{paginationModel:{pageSize:15}}},pageSizeOptions:[15],disableRowSelectionOnClick:!0}),n&&n.length>0&&"managment"===(0,h.sE)(null===c||void 0===c?void 0:c.role)&&f&&f.length>0&&f.map((e=>(0,d.jsxs)("div",{children:[(0,d.jsxs)(j.Ay,{sx:{padding:"5px",cursor:"pointer",display:"flex",justifyContent:"space-between",backgroundColor:"#002d72",color:"#fff",margin:"3px",borderRadius:"5px"},children:[(0,d.jsx)("p",{children:e.title}),(0,d.jsx)(oe,{data:e.agent})]}),(0,d.jsx)(j.Ay,{container:!0,children:e.actions.map((e=>(0,d.jsx)(j.Ay,{item:!0,lg:3,sx:{padding:"2px",cursor:"pointer"},onClick:()=>M(e),children:(0,d.jsx)(ie,{action:D(e),role:"",nombre:W(e).length,outsla:U(W(e),"OUTSLA"),insla:U(W(e),"INSLA"),lastupdate:"",bg:H(e)})},e)))})]},e._id)))]}),x&&(0,d.jsx)(de.A,{open:e,setOpen:t,title:"Result",children:(0,d.jsx)(pe,{data:x})})]})};const he=function(){const{optionSelect:e}=r.useContext(c);return(0,d.jsxs)("div",{style:{marginTop:"20px"},children:[e&&11===e.id&&(0,d.jsx)(T,{}),e&&13===e.id&&(0,d.jsx)(F,{}),e&&21===e.id&&(0,d.jsx)(U,{}),e&&22===e.id&&(0,d.jsx)(Z,{}),e&&24===e.id&&(0,d.jsx)(ue,{}),e&&23===e.id&&(0,d.jsx)($,{})]})};var ge=n(256142),je=n(801724),me=n(986430),fe=n(600249),ve=n(784707),Ae=n(83563),ye=n(914857),be=n(37476);const Se={width:36,height:36,fontSize:"1rem"},we={mt:"6px",ml:1,top:"auto",right:"auto",alignSelf:"flex-start",transform:"none"},Ce=e=>{let{texte:t,table:n}=e;const l=(0,ye.A)(),o=(0,ge.A)(l.breakpoints.down("md")),x=(0,r.useRef)(null),[p,u]=(0,r.useState)(!1),h=()=>{u((e=>!e))},g=e=>{x.current&&x.current.contains(e.target)||u(!1)},{handleSelect:j}=(0,r.useContext)(c);return(0,d.jsxs)(b.A,{sx:{flexShrink:0,ml:.75},children:[(0,d.jsx)(s.A,{disableripple:"true",color:"secondary",sx:{color:"text.primary",cursor:"pointer"},"aria-label":"open profile",ref:x,"aria-controls":p?"profile-grow":void 0,"aria-haspopup":"true",onClick:h,children:t}),(0,d.jsx)(je.A,{placement:o?"bottom":"bottom-end",open:p,anchorEl:x.current,role:void 0,transition:!0,disablePortal:!0,popperOptions:{modifiers:[{name:"offset",options:{offset:[o?-5:0,9]}}]},children:e=>{let{TransitionProps:t}=e;return(0,d.jsx)(be.A,{type:"fade",in:p,...t,children:(0,d.jsx)(i.A,{sx:{boxShadow:l.customShadows.z1,width:"100%",minWidth:285,maxWidth:420,[l.breakpoints.down("md")]:{maxWidth:285}},children:(0,d.jsx)(me.x,{onClickAway:g,children:(0,d.jsx)(a.A,{title:"",elevation:0,border:!1,content:!1,onClick:h,children:(0,d.jsx)(fe.A,{component:"nav",sx:{p:0,"& .MuiListItemButton-root":{py:.5,"& .MuiAvatar-root":Se,"& .MuiListItemSecondaryAction-root":{...we,position:"relative"}}},children:n.map((e=>(0,d.jsx)(ve.A,{onClick:()=>j(e),children:(0,d.jsx)(Ae.A,{primary:(0,d.jsxs)(s.A,{variant:"h6",children:[(0,d.jsx)(s.A,{component:"span",variant:"subtitle1",children:e.title})," "]})})},e.id)))})})})})})}})]})};const _e=function(){const e=(0,o.d4)((e=>e.menu.drawerOpen)),{socket:t}=r.useContext(l.m);return r.useEffect((()=>{t.on("renseigne",(e=>{}))}),[t]),(0,d.jsxs)(p,{children:[(0,d.jsxs)(i.A,{elevation:4,className:e?"papier_no_drawer":"papier_drawer",children:[(0,d.jsx)(s.A,{component:"p",noWrap:!0,id:"leftContent"}),(0,d.jsx)("div",{style:{display:"flex",marginLeft:"10px"},children:[{id:1,title:"Departement",child:[{id:11,title:"Client en attente"},{id:12,title:"Clients remoted"},{id:13,title:"Customer Deedline"},{id:14,title:"Performance"}]},{id:2,title:"Individually",child:[{id:21,title:"Agent"},{id:22,title:"Customer"},{id:23,title:"Statut"},{id:24,title:"All customer"}]}].map((e=>(0,d.jsx)(r.Fragment,{children:(0,d.jsx)(Ce,{texte:e.title,table:e.child})},e.id)))})]}),(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(he,{})})]})}},10302:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(541397),s=n.n(i),l=n(259051),r=n.n(l),o=n(811942),a=n.n(o),d=n(339579),c=n(315770),x=n(244414);function p(e){var t;let{index:n}=e;const i=(0,d.d4)((e=>e.agent.agent));return(0,x.jsxs)("div",{className:"result",style:"INSLA"===(0,c.Hl)(n)?{border:"1px solid black",borderRadius:"10px",padding:"5px"}:{padding:"5px",borderRadius:"10px",backgroundColor:"rgb(233, 196, 196)"},children:[(0,x.jsxs)("p",{children:[(0,x.jsx)("span",{children:"status : "})," ",n.status]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("span",{children:"Role/Agent : "})," ",n.role," ; ",null===(t=(l=n.codeAgent,s().filter(i,{codeAgent:l}))[0])||void 0===t?void 0:t.nom]}),(0,x.jsxs)("p",{style:{fontWeight:"bolder",fontSize:"13px"},children:[(0,x.jsx)("span",{children:"old status : "})," ",n.action]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("span",{children:"feedback : "})," ",null===n||void 0===n?void 0:n.feedbackSelect]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("span",{children:"comment : "})," ",n.commentaire]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("span",{children:"resolved in : "})," ",(0,c.xE)(n.dateFin,n.dateDebut)," jour(s)",(0,c.Hl)(n)]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("span",{children:"deadline : "})," ","".concat(n.delaiPrevu," ").concat((null===n||void 0===n?void 0:n.delaiPrevu)>1?" jours":" jour"),(0,x.jsx)("span",{style:{float:"right"},children:r()(n.updatedAt).fromNow()})]})]});var l}p.prototype={index:a().object};const u=p},482130:(e,t,n)=>{n.d(t,{A:()=>p});var i=n(409950),s=n(463464),l=n(428170),r=n(240033),o=n(848205),a=n(186835),d=n(182053),c=n(244414);const x=i.forwardRef((function(e,t){return(0,c.jsx)(o.A,{direction:"up",ref:t,...e})}));const p=function(e){let{open:t,children:n,setOpen:i,title:o}=e;return(0,c.jsx)("div",{children:(0,c.jsxs)(s.A,{open:t,TransitionComponent:x,keepMounted:!0,onClose:()=>{i(!1)},"aria-describedby":"alert-dialog-slide-description",children:[(0,c.jsxs)(r.A,{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)(d.A,{children:o}),(0,c.jsx)(a.A,{fontSize:"small",color:"secondary",style:{cursor:"pointer"},onClick:()=>i(!1)})]}),(0,c.jsx)(l.A,{children:n})]})})}}}]);