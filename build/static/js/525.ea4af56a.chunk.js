"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[525],{119525:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ge});var o=n(29246),a=n(602174),r=n(409950),i=n(315770),l=n(255271),s=n(244414);const c=(0,r.createContext)(),d=e=>{const[t,n]=r.useState(""),[d,p]=r.useState(),[u,v]=r.useState([]),[m,h]=r.useState(),[x,A]=r.useState();return(0,s.jsxs)(c.Provider,{value:{sendData:async()=>{try{if(n(!0),u.length>0){const e=await o.A.post(i.wp+"/client",{data:u},i.$W);console.log(e),n(!1)}}catch(e){console.log(e)}},readUploadFile:(e,t)=>{e.preventDefault(),n(!0);try{if(e.target.files){const o=new FileReader;o.onload=e=>{const o=e.target.result,a=l.LF(o,{type:"array"}),r=a.SheetNames[0],i=a.Sheets[r],s=l.Wp.sheet_to_json(i);t(s),n(!1)},o.readAsArrayBuffer(e.target.files[0])}}catch(o){alert("Error "+o)}},sending:t,setSending:n,setVisited:p,visited:d,setAllAdresse:h,allAdresse:m,appelSortant:x,setAppelSortant:A,setTrack:v,track:u},children:[e.children,t&&(0,s.jsx)(a.A,{open:t})]})},p=r.memo(d);var u=n(260899),v=n(716491),m=n(689505),h=n(198587),x=n(58168),A=n(672004),f=n(147896);const b=r.createContext({});const S=b,g=r.createContext({});const y=g;var j=n(548283),L=n(559254),w=n(110178),_=n(107594);function C(e){return(0,_.Ay)("MuiStep",e)}(0,w.A)("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const N=["active","children","className","component","completed","disabled","expanded","index","last"],M=(0,L.Ay)("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.completed&&t.completed]}})((e=>{let{ownerState:t}=e;return(0,x.A)({},"horizontal"===t.orientation&&{paddingLeft:8,paddingRight:8},t.alternativeLabel&&{flex:1,position:"relative"})})),R=r.forwardRef((function(e,t){const n=(0,j.A)({props:e,name:"MuiStep"}),{active:o,children:a,className:i,component:l="div",completed:c,disabled:d,expanded:p=!1,index:u,last:v}=n,m=(0,h.A)(n,N),{activeStep:b,connector:g,alternativeLabel:L,orientation:w,nonLinear:_}=r.useContext(S);let[R=!1,k=!1,z=!1]=[o,c,d];b===u?R=void 0===o||o:!_&&b>u?k=void 0===c||c:!_&&b<u&&(z=void 0===d||d);const D=r.useMemo((()=>({index:u,last:v,expanded:p,icon:u+1,active:R,completed:k,disabled:z})),[u,v,p,R,k,z]),q=(0,x.A)({},n,{active:R,orientation:w,alternativeLabel:L,completed:k,disabled:z,expanded:p,component:l}),I=(e=>{const{classes:t,orientation:n,alternativeLabel:o,completed:a}=e,r={root:["root",n,o&&"alternativeLabel",a&&"completed"]};return(0,f.A)(r,C,t)})(q),T=(0,s.jsxs)(M,(0,x.A)({as:l,className:(0,A.A)(I.root,i),ref:t,ownerState:q},m,{children:[g&&L&&0!==u?g:null,a]}));return(0,s.jsx)(y.Provider,{value:D,children:g&&!L&&0!==u?(0,s.jsxs)(r.Fragment,{children:[g,T]}):T})}));var k=n(965471);const z=(0,k.A)((0,s.jsx)("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),D=(0,k.A)((0,s.jsx)("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");var q=n(309360);function I(e){return(0,_.Ay)("MuiStepIcon",e)}const T=(0,w.A)("MuiStepIcon",["root","active","completed","error","text"]);var F;const E=["active","className","completed","error","icon"],P=(0,L.Ay)(q.A,{name:"MuiStepIcon",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;return{display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),color:(t.vars||t).palette.text.disabled,["&.".concat(T.completed)]:{color:(t.vars||t).palette.primary.main},["&.".concat(T.active)]:{color:(t.vars||t).palette.primary.main},["&.".concat(T.error)]:{color:(t.vars||t).palette.error.main}}})),W=(0,L.Ay)("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(e,t)=>t.text})((e=>{let{theme:t}=e;return{fill:(t.vars||t).palette.primary.contrastText,fontSize:t.typography.caption.fontSize,fontFamily:t.typography.fontFamily}})),U=r.forwardRef((function(e,t){const n=(0,j.A)({props:e,name:"MuiStepIcon"}),{active:o=!1,className:a,completed:r=!1,error:i=!1,icon:l}=n,c=(0,h.A)(n,E),d=(0,x.A)({},n,{active:o,completed:r,error:i}),p=(e=>{const{classes:t,active:n,completed:o,error:a}=e,r={root:["root",n&&"active",o&&"completed",a&&"error"],text:["text"]};return(0,f.A)(r,I,t)})(d);if("number"===typeof l||"string"===typeof l){const e=(0,A.A)(a,p.root);return i?(0,s.jsx)(P,(0,x.A)({as:D,className:e,ref:t,ownerState:d},c)):r?(0,s.jsx)(P,(0,x.A)({as:z,className:e,ref:t,ownerState:d},c)):(0,s.jsxs)(P,(0,x.A)({className:e,ref:t,ownerState:d},c,{children:[F||(F=(0,s.jsx)("circle",{cx:"12",cy:"12",r:"12"})),(0,s.jsx)(W,{className:p.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:d,children:l})]}))}return l}));function B(e){return(0,_.Ay)("MuiStepLabel",e)}const V=(0,w.A)("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),O=["children","className","componentsProps","error","icon","optional","slotProps","StepIconComponent","StepIconProps"],H=(0,L.Ay)("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation]]}})((e=>{let{ownerState:t}=e;return(0,x.A)({display:"flex",alignItems:"center",["&.".concat(V.alternativeLabel)]:{flexDirection:"column"},["&.".concat(V.disabled)]:{cursor:"default"}},"vertical"===t.orientation&&{textAlign:"left",padding:"8px 0"})})),K=(0,L.Ay)("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(e,t)=>t.label})((e=>{let{theme:t}=e;return(0,x.A)({},t.typography.body2,{display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),["&.".concat(V.active)]:{color:(t.vars||t).palette.text.primary,fontWeight:500},["&.".concat(V.completed)]:{color:(t.vars||t).palette.text.primary,fontWeight:500},["&.".concat(V.alternativeLabel)]:{marginTop:16},["&.".concat(V.error)]:{color:(t.vars||t).palette.error.main}})})),Z=(0,L.Ay)("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(e,t)=>t.iconContainer})((()=>({flexShrink:0,display:"flex",paddingRight:8,["&.".concat(V.alternativeLabel)]:{paddingRight:0}}))),$=(0,L.Ay)("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(e,t)=>t.labelContainer})((e=>{let{theme:t}=e;return{width:"100%",color:(t.vars||t).palette.text.secondary,["&.".concat(V.alternativeLabel)]:{textAlign:"center"}}})),G=r.forwardRef((function(e,t){var n;const o=(0,j.A)({props:e,name:"MuiStepLabel"}),{children:a,className:i,componentsProps:l={},error:c=!1,icon:d,optional:p,slotProps:u={},StepIconComponent:v,StepIconProps:m}=o,b=(0,h.A)(o,O),{alternativeLabel:g,orientation:L}=r.useContext(S),{active:w,disabled:_,completed:C,icon:N}=r.useContext(y),M=d||N;let R=v;M&&!R&&(R=U);const k=(0,x.A)({},o,{active:w,alternativeLabel:g,completed:C,disabled:_,error:c,orientation:L}),z=(e=>{const{classes:t,orientation:n,active:o,completed:a,error:r,disabled:i,alternativeLabel:l}=e,s={root:["root",n,r&&"error",i&&"disabled",l&&"alternativeLabel"],label:["label",o&&"active",a&&"completed",r&&"error",i&&"disabled",l&&"alternativeLabel"],iconContainer:["iconContainer",o&&"active",a&&"completed",r&&"error",i&&"disabled",l&&"alternativeLabel"],labelContainer:["labelContainer",l&&"alternativeLabel"]};return(0,f.A)(s,B,t)})(k),D=null!=(n=u.label)?n:l.label;return(0,s.jsxs)(H,(0,x.A)({className:(0,A.A)(z.root,i),ref:t,ownerState:k},b,{children:[M||R?(0,s.jsx)(Z,{className:z.iconContainer,ownerState:k,children:(0,s.jsx)(R,(0,x.A)({completed:C,active:w,error:c,icon:M},m))}):null,(0,s.jsxs)($,{className:z.labelContainer,ownerState:k,children:[a?(0,s.jsx)(K,(0,x.A)({ownerState:k},D,{className:(0,A.A)(z.label,null==D?void 0:D.className),children:a})):null,p]})]}))}));G.muiName="StepLabel";const J=G;function Q(e){return(0,_.Ay)("MuiStepper",e)}(0,w.A)("MuiStepper",["root","horizontal","vertical","alternativeLabel"]);var X=n(647171);function Y(e){return(0,_.Ay)("MuiStepConnector",e)}(0,w.A)("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const ee=["className"],te=(0,L.Ay)("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.completed&&t.completed]}})((e=>{let{ownerState:t}=e;return(0,x.A)({flex:"1 1 auto"},"vertical"===t.orientation&&{marginLeft:12},t.alternativeLabel&&{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"})})),ne=(0,L.Ay)("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.line,t["line".concat((0,X.A)(n.orientation))]]}})((e=>{let{ownerState:t,theme:n}=e;const o="light"===n.palette.mode?n.palette.grey[400]:n.palette.grey[600];return(0,x.A)({display:"block",borderColor:n.vars?n.vars.palette.StepConnector.border:o},"horizontal"===t.orientation&&{borderTopStyle:"solid",borderTopWidth:1},"vertical"===t.orientation&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})})),oe=r.forwardRef((function(e,t){const n=(0,j.A)({props:e,name:"MuiStepConnector"}),{className:o}=n,a=(0,h.A)(n,ee),{alternativeLabel:i,orientation:l="horizontal"}=r.useContext(S),{active:c,disabled:d,completed:p}=r.useContext(y),u=(0,x.A)({},n,{alternativeLabel:i,orientation:l,active:c,completed:p,disabled:d}),v=(e=>{const{classes:t,orientation:n,alternativeLabel:o,active:a,completed:r,disabled:i}=e,l={root:["root",n,o&&"alternativeLabel",a&&"active",r&&"completed",i&&"disabled"],line:["line","line".concat((0,X.A)(n))]};return(0,f.A)(l,Y,t)})(u);return(0,s.jsx)(te,(0,x.A)({className:(0,A.A)(v.root,o),ref:t,ownerState:u},a,{children:(0,s.jsx)(ne,{className:v.line,ownerState:u})}))})),ae=["activeStep","alternativeLabel","children","className","component","connector","nonLinear","orientation"],re=(0,L.Ay)("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel]}})((e=>{let{ownerState:t}=e;return(0,x.A)({display:"flex"},"horizontal"===t.orientation&&{flexDirection:"row",alignItems:"center"},"vertical"===t.orientation&&{flexDirection:"column"},t.alternativeLabel&&{alignItems:"flex-start"})})),ie=(0,s.jsx)(oe,{}),le=r.forwardRef((function(e,t){const n=(0,j.A)({props:e,name:"MuiStepper"}),{activeStep:o=0,alternativeLabel:a=!1,children:i,className:l,component:c="div",connector:d=ie,nonLinear:p=!1,orientation:u="horizontal"}=n,v=(0,h.A)(n,ae),m=(0,x.A)({},n,{alternativeLabel:a,orientation:u,component:c}),b=(e=>{const{orientation:t,alternativeLabel:n,classes:o}=e,a={root:["root",t,n&&"alternativeLabel"]};return(0,f.A)(a,Q,o)})(m),g=r.Children.toArray(i).filter(Boolean),y=g.map(((e,t)=>r.cloneElement(e,(0,x.A)({index:t,last:t+1===g.length},e.props)))),L=r.useMemo((()=>({activeStep:o,alternativeLabel:a,connector:d,nonLinear:p,orientation:u})),[o,a,d,p,u]);return(0,s.jsx)(S.Provider,{value:L,children:(0,s.jsx)(re,(0,x.A)({as:c,ownerState:m,className:(0,A.A)(b.root,l),ref:t},v,{children:y}))})})),se=le;var ce=n(182053),de=n(477515);const pe=function(){const{readUploadFile:e,setAllAdresse:t}=r.useContext(c);return(0,s.jsx)("div",{children:(0,s.jsxs)(u.Ay,{item:!0,lg:3,xs:12,sm:6,md:6,sx:{paddingLeft:"10px"},children:[(0,s.jsx)(ce.A,{component:"p",noWrap:!0,children:"All Adresse"}),(0,s.jsx)(de.A,{type:"file",accept:".xlsx",name:"upload",id:"upload",onChange:n=>e(n,t)})]})})};var ue=n(541397),ve=n.n(ue);const me=function(){const{readUploadFile:e,allAdresse:t,setAppelSortant:n,track:o,appelSortant:a}=r.useContext(c),[i,l]=r.useState(),d=e=>{if(e.length>0){if(12===e.length)return e;if(13===e.length)return Array.from(e).slice(1).join("");if(9===e.length)return"243"+e;if(10===e.length)return"243"+Array.from(e).slice(1).join("")}};return r.useEffect((()=>{(()=>{if(t&&i&&i.length>0){let o=[];for(let n=0;n<i.length;n++)"outbound"===i[n].Type&&o.push({UniqueID:i[n].UniqueID,unique_account_id:(e=i[n].Destination,ve().filter(t,{customer_phone_1:d(e)}).length>0||ve().filter(t,{customer_phone_2:d(e)}).length>0?ve().filter(t,{customer_phone_1:d(e)})[0].unique_account_id:void 0),Source:i[n].Source,Destination:i[n].Destination,feedback:i[n].Feedback,StartTime:i[n].StartTime,EndTime:i[n].EndTime,Duration:i[n].Duration,Disposition:i[n].Disposition,appel:!0});n(o)}var e})()}),[t,i]),(0,s.jsx)("div",{children:(0,s.jsxs)(u.Ay,{item:!0,lg:3,xs:12,sm:6,md:6,sx:{paddingLeft:"10px"},children:[(0,s.jsx)(ce.A,{children:"Appel"}),(0,s.jsx)(de.A,{type:"file",name:"upload",id:"upload",onChange:t=>e(t,l)})]})})};var he=n(541233),xe=n(339579),Ae=n(314136);const fe=function(){const{track:e}=r.useContext(c),t=(0,xe.d4)((e=>{var t;return null===(t=e.action)||void 0===t?void 0:t.action}));let n=ve().groupBy(e,"beginAction");const o=e=>ve().filter(t,{idAction:e}),a=[{field:"unique_account_id",headerName:"ID",width:110,editable:!1},{field:"customer_name",headerName:"customer_name",width:130,editable:!1},{field:"shop_region",headerName:"Region",width:80,editable:!1},{field:"shop_name",headerName:"Shop",width:100,editable:!1},{field:"par_to_date",headerName:"PAR",width:130,editable:!1},{field:"beginAction",headerName:"apr\xe8s Analyse",width:200,editable:!1,renderCell:e=>{var t;return null===(t=o(e.row.beginAction)[0])||void 0===t?void 0:t.title}}];return(0,s.jsx)("div",{style:{marginTop:"20px"},children:(0,s.jsxs)(u.Ay,{container:!0,children:[(0,s.jsx)(u.Ay,{item:!0,lg:8,children:e&&e.length>0&&(0,s.jsx)(Ae.zh,{getRowId:function(e){return e.customer_name},rows:e,columns:a,initialState:{pagination:{paginationModel:{pageSize:10}}},pageSizeOptions:[10],disableRowSelectionOnClick:!0})}),(0,s.jsx)(u.Ay,{item:!0,lg:4,children:Object.keys(n).map(((e,t)=>{var a,r,i;return(0,s.jsxs)("div",{className:"actionAnalyse",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"actionTitle",children:o(e).length>0?null===(a=o(e)[0])||void 0===a?void 0:a.title:"Action introuvable"}),(0,s.jsx)("p",{style:{fontSize:"11px",fontWeight:"bolder"},className:"actionTitle",children:o(e).length>0&&(null===(r=o(e)[0])||void 0===r||null===(i=r.roles[0])||void 0===i?void 0:i.title)})]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"actionTaille",children:n[e].length})})]},t)}))})]})})};const be=function(){const{readUploadFile:e,setVisited:t,visited:n,setTrack:a,setSending:l,sendData:d,appelSortant:p}=r.useContext(c),[v,h]=r.useState([]),[x,A]=he.Ay.useMessage(),f=async()=>{try{if(v.length>0){let e=[];for(let t=0;t<v.length;t++)e.push(v[t].unique_account_id);l(!0);const n=await o.A.post(i.UZ+"/visited",{client:e});t(n.data),l(!1)}}catch(a){"ERR_NETWORK"===a.code&&(e="Network Error",n="error",x.open({type:n,content:""+e,duration:3}),l(!1))}var e,n};r.useEffect((()=>{f()}),[v]);const b=(e,t)=>{let o=ve().filter(n,{codeclient:e});return o.length>0?["dateSave","idDemande"].includes(t)?o[0][""+t]:"codeAgent"===t?null===(a=o[0])||void 0===a?void 0:a.demandeur.codeAgent:"raison"===t?null===(r=o[0])||void 0===r?void 0:r.demande.raison:void 0:"";var a,r},S=(e,t)=>e.length>0?"appel"===t?"called":"visited":"appel"===t?"nCalled":"nVisited",g=(0,xe.d4)((e=>null===e||void 0===e?void 0:e.initiale.initiale)),y=(e,t)=>{var n;return null===(n=ve().filter(g,{visited:e,called:t})[0])||void 0===n?void 0:n.action};return r.useEffect((()=>{(()=>{try{let e=[];for(let t=0;t<v.length;t++)e.push({...v[t],objectVisite:{codeAgent:b(v[t].unique_account_id,"codeAgent"),idDemande:b(v[t].unique_account_id,"idDemande"),raison:b(v[t].unique_account_id,"raison"),dateSave:b(v[t].unique_account_id,"dateSave")},actionEnCours:y(S(ve().filter(n,{codeclient:v[t].unique_account_id}),"visite"),S(ve().filter(p,{unique_account_id:v[t].unique_account_id}),"appel")),beginAction:y(S(ve().filter(n,{codeclient:v[t].unique_account_id}),"visite"),S(ve().filter(p,{unique_account_id:v[t].unique_account_id}),"appel")),called:S(ve().filter(p,{unique_account_id:v[t].unique_account_id}),"appel"),visited:S(ve().filter(n,{codeclient:v[t].unique_account_id}),"visite")});a(e)}catch(e){console.log(e)}})()}),[n]),(0,s.jsxs)(u.Ay,{container:!0,children:[A,(0,s.jsx)(u.Ay,{item:!0,lg:9,sm:6,md:6,sx:{paddingLeft:"10px"},children:(0,s.jsx)(de.A,{type:"file",name:"upload",id:"upload",onChange:t=>e(t,h)})}),(0,s.jsx)(u.Ay,{item:!0,lg:3,sm:6,md:6,sx:{paddingLeft:"10px"},children:(0,s.jsx)(m.A,{color:"primary",variant:"contained",onClick:e=>d(e),children:"send"})}),(0,s.jsx)(fe,{})]})},Se=["All addresses","All calls","Customers to track"];function ge(){const[e,t]=r.useState(0),[n,o]=r.useState(new Set),a=e=>n.has(e);return(0,s.jsx)(p,{children:(0,s.jsxs)(v.A,{sx:{width:"100%"},children:[(0,s.jsx)(se,{activeStep:e,children:Se.map(((e,t)=>{const n={};return a(t)&&(n.completed=!1),(0,s.jsx)(R,{...n,children:(0,s.jsx)(J,{children:e})},e)}))}),(0,s.jsxs)(r.Fragment,{children:[0===e&&(0,s.jsx)(u.Ay,{children:(0,s.jsx)(pe,{})}),1===e&&(0,s.jsx)(u.Ay,{children:(0,s.jsx)(me,{})}),2===e&&(0,s.jsx)(u.Ay,{children:(0,s.jsx)(be,{})}),(0,s.jsxs)(v.A,{sx:{display:"flex",flexDirection:"row",pt:2},children:[(0,s.jsx)(m.A,{color:"inherit",disabled:0===e,onClick:()=>{t((e=>e-1))},sx:{mr:1},children:"Back"}),(0,s.jsx)(v.A,{sx:{flex:"1 1 auto"}}),(0,s.jsx)(m.A,{onClick:()=>{let r=n;a(e)&&(r=new Set(r.values()),r.delete(e)),t((e=>e+1)),o(r)},children:e===Se.length-1?"Finish":"Next"})]})]})]})})}}}]);